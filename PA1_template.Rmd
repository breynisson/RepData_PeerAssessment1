# Reproducible Research: Peer Assessment 1


## Loading and preprocessing the data

We assume that the data is present in the workspace. If not, the data should be loaded and unzipped into the workspace. We load the data into our environment:

```{r}
data<-read.csv("activity.csv")
```
 
Let's take a look at the data:

```{r}
str(data)
```
 
We transform the date column into date-types:

```{r}
data$date<-as.Date(as.character(data$date))
```
 
And check the data again, to verify that our transformation worked:

```{r}
str(data)
```


## What is mean total number of steps taken per day?

We sum the number of steps per day and plot the histogram:

```{r, fig.width=8}
library(plyr)
spd<-ddply(data, .(date), summarize, steps_per_day = sum(steps))
spd_cc<-na.omit(spd)
par(mar=c(4,5,1.5,1.5))
with(spd_cc, plot(date,steps_per_day, type="h", 
                  lwd=8, col="gold", main="Total number of steps per day",
                  xlab="Dates in 2012", ylab="Steps per day", cex.axis=0.7,
                  las=1,mgp=c(2,0.2,0), tck=0.02))
 
```


Calculation of the mean and median total number of steps per day:

```{r}
df<-ddply(data, .(date), summarize,mean_value = mean(steps, na.rm=TRUE), 
          median_value = median(steps, na.rm=TRUE))
colnames(df)<-c("Date", "Mean", "Median")
print.data.frame(df, right=FALSE, row.names=FALSE)
```

## What is the average daily activity pattern?
```{r, fig.width=8}
av_per_int_df<-ddply(data, .(interval), summarize, ave_per_interval = mean(steps, na.rm=TRUE))
av_per_in_df_cc<-na.omit(av_per_int_df)
with(av_per_in_df_cc, plot(ave_per_interval, type="l",
                           xlab="Interval", ylab="Average Steps Per Interval",
                           main="Average Daily Activity Pattern"))
```

We find the interval with the highest average number of steps:

```{r, results='asis'}
which.max(av_per_in_df_cc$ave_per_interval)
```

## Inputing missing values

We start off by calculating missing values:
```{r}
count(is.na(data$steps))
```



## Are there differences in activity patterns between weekdays and weekends?
